{"version":3,"file":"minecraft_text.min.js","sources":["../src/functions/to-html.ts","../src/utils.ts","../src/functions/obfuscate.ts","../src/constants.ts","../src/plugins/jquery.ts","../src/index.ts"],"sourcesContent":["import { COLOR_CODES, STYLE_CODES } from '../constants';\n\nexport function toHTML (text: string) {\n  let output = '';\n\n  let lastColorLevel = 0;\n  let lastStyleLevel = 0;\n\n  let obfuscating = false;\n\n  function cleanStyles () {\n    for (let i = 0; i < lastColorLevel + lastStyleLevel; i++) {\n      output += '</span>';\n    }\n    lastColorLevel = lastStyleLevel = 0;\n  }\n\n  for (let i = 0; i < text.length; i += 1) {\n    let char = text[i];\n    const nextCode = text[i + 1];\n\n    if (char === '\\\\' && nextCode === 'n') {\n      cleanStyles();\n      char = '<br>';\n      i += 1;\n    }\n\n    if (char === '&' || char === '\\u00A7') {\n      let lastStyle = COLOR_CODES[nextCode];\n      // Is color?\n      if (lastStyle != null) {\n        if (lastColorLevel > 0 || lastStyleLevel > 0) {\n          cleanStyles();\n        }\n\n        if (obfuscating) {\n          output += '</span>';\n          obfuscating = false;\n        }\n\n        output += `<span style=\"color: ${lastStyle.inline};\">`;\n        lastColorLevel++;\n        i++;\n        continue;\n      }\n\n      lastStyle = STYLE_CODES[nextCode];\n      // Is style?\n      if (lastStyle != null) {\n        if (obfuscating)\n          output += '</span>';\n\n        output += `<span style=\"${lastStyle.inline};\">`;\n        lastStyleLevel++;\n        i++;\n\n        if (obfuscating)\n          output += '<span class=\"kurcraft-obfuscate\">';\n        continue;\n      }\n\n      // Is obfuscate?\n      if (nextCode === 'k') {\n        obfuscating = true;\n        output += '<span class=\"kurcraft-obfuscate\">';\n        i++;\n        continue;\n      }\n\n      // Is reset?\n      if (nextCode === 'r') {\n        cleanStyles();\n        i++;\n        continue;\n      }\n    }\n\n    if (char === ' ') {\n      char = '&nbsp;';\n    }\n\n    output += char;\n  }\n\n  cleanStyles();\n  return output;\n}\n","export function randomRange (min: number, max: number): number {\n  return Math.floor(Math.random() * (max - min + 1)) + min;\n}\n","import { randomRange } from '../utils';\n\nlet obfuscates: Element[] = [];\nlet obfuscateAnimationReqeastId = -1;\n\nexport function obfuscateUpdate () {\n  if (obfuscates == null || obfuscates.length === 0)\n    return;\n\n  obfuscateAnimationReqeastId = window.requestAnimationFrame(obfuscateUpdate);\n\n  for (let i in obfuscates) {\n    const obfuscateElement = obfuscates[i];\n    let randStr = '';\n    const elementStr = obfuscateElement.innerHTML.replace(/&(?:.|\\n)*?;/gm, ' ');\n    for (let j = 0; j < elementStr.length; j++) {\n      randStr += String.fromCharCode(randomRange(64, 95));\n    }\n    obfuscateElement.innerHTML = randStr;\n  }\n}\n\nexport function refeashObfuscate (rootElement: HTMLElement) {\n  if (typeof window === 'undefined') {\n    return console.warn('[MinecraftTextJS] refeashObfuscate(rootElement?) only support on browser');\n  }\n\n  window.cancelAnimationFrame(obfuscateAnimationReqeastId);\n  obfuscates.length = 0;\n\n  const fromElement = rootElement || document;\n\n  obfuscates = Array.prototype.slice.call(fromElement.getElementsByClassName('kurcraft-obfuscate'));\n  obfuscateUpdate();\n}\n","export interface CodesSettings {\n  [code: string]: {\n    inline: string;\n    className: string;\n  };\n}\n\nexport const COLOR_CODES: CodesSettings = {\n  0: {\n    inline: '#000000',\n    className: '',\n  },\n  1: {\n    inline: '#0000AA',\n    className: '',\n  },\n  2: {\n    inline: '#00AA00',\n    className: '',\n  },\n  3: {\n    inline: '#00AAAA',\n    className: '',\n  },\n  4: {\n    inline: '#AA0000',\n    className: '',\n  },\n  5: {\n    inline: '#AA00AA',\n    className: '',\n  },\n  6: {\n    inline: '#FFAA00',\n    className: '',\n  },\n  7: {\n    inline: '#AAAAAA',\n    className: '',\n  },\n  8: {\n    inline: '#555555',\n    className: '',\n  },\n  9: {\n    inline: '#5555FF',\n    className: '',\n  },\n  a: {\n    inline: '#55FF55',\n    className: '',\n  },\n  b: {\n    inline: '#55FFFF',\n    className: '',\n  },\n  c: {\n    inline: '#FF5555',\n    className: '',\n  },\n  d: {\n    inline: '#FF55FF',\n    className: '',\n  },\n  e: {\n    inline: '#FFFF55',\n    className: '',\n  },\n  f: {\n    inline: '#FFFFFF',\n    className: '',\n  },\n};\n\nexport const STYLE_CODES: CodesSettings = {\n  l: {\n    inline: 'font-weight: bold',\n    className: '',\n  },\n  m: {\n    inline: 'text-decoration: line-through',\n    className: '',\n  },\n  n: {\n    inline: 'text-decoration: underline',\n    className: '',\n  },\n  o: {\n    inline: 'font-style: italic',\n    className: '',\n  },\n};\n","import { toHTML } from '../functions/to-html';\nimport { refeashObfuscate } from '../functions/obfuscate';\n\nfunction initJQuery ($: JQueryStatic) {\n  $.fn.minecraftText = function () {\n    this.toHTML = function (text: string) {\n      this.html(toHTML(text));\n    };\n\n    this.refeashObfuscate = function () {\n      refeashObfuscate(this[0]);\n    };\n\n    return this;\n  };\n}\n\nlet jQuery = null;\ntry {\n  if (typeof self !== 'undefined') {\n    jQuery = self.jQuery;\n  }\n\n  if (typeof require !== 'undefined') {\n    jQuery = require('jquery');\n  }\n} catch (err) {}\nif (jQuery) {\n  initJQuery(jQuery);\n}\n","import './plugins/jquery';\n\nimport { toHTML } from './functions/to-html';\nimport { refeashObfuscate } from './functions/obfuscate';\n\nexport default {\n  toHTML,\n  refeashObfuscate,\n};\n"],"names":["toHTML","text","cleanStyles","i","lastColorLevel","lastStyleLevel","output","obfuscating","length","char","nextCode","lastStyle","COLOR_CODES","inline","STYLE_CODES","randomRange","min","max","Math","floor","random","obfuscateUpdate","String","fromCharCode","obfuscates","obfuscateAnimationReqeastId","window","requestAnimationFrame","obfuscateElement","randStr","elementStr","innerHTML","replace","j","refeashObfuscate","rootElement","console","warn","cancelAnimationFrame","fromElement","document","Array","prototype","slice","call","getElementsByClassName","className","a","b","c","d","e","f","l","m","n","o","jQuery","self","require","err","$","fn","minecraftText","html","initJQuery"],"mappings":"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"}