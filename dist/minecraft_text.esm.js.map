{"version":3,"file":"minecraft_text.esm.js","sources":["../src/constants.ts","../src/utils.ts","../src/functions/to-html.ts","../src/functions/obfuscate.ts","../src/plugins/jquery.ts","../src/index.ts"],"sourcesContent":["export interface CodesSettings {\n  [code: string]: {\n    inline: string;\n    className: string;\n  };\n}\n\nexport const COLOR_CODES: CodesSettings = {\n  0: {\n    inline: '#000000',\n    className: '',\n  },\n  1: {\n    inline: '#0000AA',\n    className: '',\n  },\n  2: {\n    inline: '#00AA00',\n    className: '',\n  },\n  3: {\n    inline: '#00AAAA',\n    className: '',\n  },\n  4: {\n    inline: '#AA0000',\n    className: '',\n  },\n  5: {\n    inline: '#AA00AA',\n    className: '',\n  },\n  6: {\n    inline: '#FFAA00',\n    className: '',\n  },\n  7: {\n    inline: '#AAAAAA',\n    className: '',\n  },\n  8: {\n    inline: '#555555',\n    className: '',\n  },\n  9: {\n    inline: '#5555FF',\n    className: '',\n  },\n  a: {\n    inline: '#55FF55',\n    className: '',\n  },\n  b: {\n    inline: '#55FFFF',\n    className: '',\n  },\n  c: {\n    inline: '#FF5555',\n    className: '',\n  },\n  d: {\n    inline: '#FF55FF',\n    className: '',\n  },\n  e: {\n    inline: '#FFFF55',\n    className: '',\n  },\n  f: {\n    inline: '#FFFFFF',\n    className: '',\n  },\n};\n\nexport const STYLE_CODES: CodesSettings = {\n  l: {\n    inline: 'font-weight: bold',\n    className: '',\n  },\n  m: {\n    inline: 'text-decoration: line-through',\n    className: '',\n  },\n  n: {\n    inline: 'text-decoration: underline',\n    className: '',\n  },\n  o: {\n    inline: 'font-style: italic',\n    className: '',\n  },\n};\n","export function randomRange (min: number, max: number): number {\n  return Math.floor(Math.random() * (max - min + 1)) + min;\n}\n\nexport function stringToHtmlEntities (str: string): string {\n  return str.replace(/[\\u00A0-\\u9999<>\\&]/gim, (c: string) => {\n    return `&#${c.charCodeAt(0)};`;\n  });\n}\n","import { COLOR_CODES, STYLE_CODES } from '../constants';\nimport { stringToHtmlEntities } from '../utils';\n\nexport function toHTML (text: string) {\n  let output = '';\n\n  let lastColorLevel = 0;\n  let lastStyleLevel = 0;\n\n  let obfuscating = false;\n\n  function cleanStyles () {\n    for (let i = 0; i < lastColorLevel + lastStyleLevel; i++) {\n      output += '</span>';\n    }\n    lastColorLevel = lastStyleLevel = 0;\n  }\n\n  for (let i = 0; i < text.length; i += 1) {\n    const char = text[i];\n    const nextCode = text[i + 1];\n\n    if (char === '\\\\' && nextCode === 'n') {\n      cleanStyles();\n      output += '<br>';\n      i += 1;\n      continue;\n    }\n\n    if (char === ' ') {\n      output += '&nbsp;';\n      continue;\n    }\n\n    if (char === '&' || char === '\\u00A7') {\n      let lastStyle = COLOR_CODES[nextCode];\n      // Is color?\n      if (lastStyle != null) {\n        if (lastColorLevel > 0 || lastStyleLevel > 0) {\n          cleanStyles();\n        }\n\n        if (obfuscating) {\n          output += '</span>';\n          obfuscating = false;\n        }\n\n        output += `<span style=\"color: ${lastStyle.inline};\">`;\n        lastColorLevel++;\n        i++;\n        continue;\n      }\n\n      lastStyle = STYLE_CODES[nextCode];\n      // Is style?\n      if (lastStyle != null) {\n        if (obfuscating)\n          output += '</span>';\n\n        output += `<span style=\"${lastStyle.inline};\">`;\n        lastStyleLevel++;\n        i++;\n\n        if (obfuscating)\n          output += '<span class=\"kurcraft-obfuscate\">';\n        continue;\n      }\n\n      // Is obfuscate?\n      if (nextCode === 'k') {\n        obfuscating = true;\n        output += '<span class=\"kurcraft-obfuscate\">';\n        i++;\n        continue;\n      }\n\n      // Is reset?\n      if (nextCode === 'r') {\n        cleanStyles();\n        i++;\n        continue;\n      }\n    }\n\n    output += stringToHtmlEntities(char);\n  }\n\n  cleanStyles();\n  return output;\n}\n","import { randomRange } from '../utils';\n\nlet obfuscates: Element[] = [];\nlet obfuscateAnimationReqeastId = -1;\n\nexport function obfuscateUpdate () {\n  if (obfuscates == null || obfuscates.length === 0)\n    return;\n\n  obfuscateAnimationReqeastId = window.requestAnimationFrame(obfuscateUpdate);\n\n  for (let i in obfuscates) {\n    const obfuscateElement = obfuscates[i];\n    let randStr = '';\n    const elementStr = obfuscateElement.innerHTML.replace(/&(?:.|\\n)*?;/gm, ' ');\n    for (let j = 0; j < elementStr.length; j++) {\n      randStr += String.fromCharCode(randomRange(64, 95));\n    }\n    obfuscateElement.innerHTML = randStr;\n  }\n}\n\nexport function refeashObfuscate (rootElement: HTMLElement) {\n  if (typeof window === 'undefined') {\n    return console.warn('[MinecraftTextJS] refeashObfuscate(rootElement?) only support on browser');\n  }\n\n  window.cancelAnimationFrame(obfuscateAnimationReqeastId);\n  obfuscates.length = 0;\n\n  const fromElement = rootElement || document;\n\n  obfuscates = Array.prototype.slice.call(fromElement.getElementsByClassName('kurcraft-obfuscate'));\n  obfuscateUpdate();\n}\n","import { toHTML } from '../functions/to-html';\nimport { refeashObfuscate } from '../functions/obfuscate';\n\nfunction initJQuery ($: JQueryStatic) {\n  $.fn.minecraftText = function () {\n    this.toHTML = function (text: string) {\n      this.html(toHTML(text));\n    };\n\n    this.refeashObfuscate = function () {\n      refeashObfuscate(this[0]);\n    };\n\n    return this;\n  };\n}\n\nlet jQuery = null;\ntry {\n  if (typeof self !== 'undefined') {\n    jQuery = self.jQuery;\n  }\n\n  if (typeof require !== 'undefined') {\n    jQuery = require('jquery');\n  }\n} catch (err) {}\nif (jQuery) {\n  initJQuery(jQuery);\n}\n","import './plugins/jquery';\n\nimport { toHTML } from './functions/to-html';\nimport { refeashObfuscate } from './functions/obfuscate';\n\nexport default {\n  toHTML,\n  refeashObfuscate,\n};\n"],"names":["COLOR_CODES","inline","className","a","b","c","d","e","f","STYLE_CODES","l","m","n","o","randomRange","min","max","Math","floor","random","stringToHtmlEntities","str","replace","charCodeAt","toHTML","text","output","lastColorLevel","lastStyleLevel","obfuscating","cleanStyles","i","length","char","nextCode","lastStyle","obfuscates","obfuscateAnimationReqeastId","obfuscateUpdate","window","requestAnimationFrame","obfuscateElement","randStr","elementStr","innerHTML","j","String","fromCharCode","refeashObfuscate","rootElement","console","warn","cancelAnimationFrame","fromElement","document","Array","prototype","slice","call","getElementsByClassName","initJQuery","$","fn","minecraftText","html","jQuery","self","require","err"],"mappings":"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"}